41장 타이머
===


호출 스케줄링
---
- 호출 스케줄링: 함수를 명시적으로 호출하지 않고 일정 시간이 경과된 이후에 호출되도록 함수 호출을 예약하기 위해 타이머 함수를 사용하는 것
- JS는 타이머를 생성할 수 있는 타이머 함수 setTimeout과 setInterval, 타이머를 제거할 수 있는 타이머 함수 clearTimeout과 clearInterval을 제공한다.
- 타이머 함수는 ECMAScript 사양에 정의된 빌트인 함수가 아니라 호스트 객체다.
- setTimeout과 setInterval이 생성한 타이머가 만료되면 콜백 함수가 호출된다. setTimeouiut 함수의 콜백 함수는 타이머가 만료되면 단 한 번 호출되고, setInterval 함수의 콜백 함수는 타이머가 만료될 때마다 반복 호출된다.
- JS는 싱글 스레드로 동작하므로 setTimeout과 setInterval은 비동기 처리 방식으로 동작한다.

타이머 함수
---
- setTimeout / clearTimeout
  - ![image](https://github.com/user-attachments/assets/1665ea77-b8f6-4a04-85d9-9c6802db6683)
  ```
  // 1초 후 콜백 함수 호출 및 콜백 함수에 인수 전달
  setTimeout(() => console.log(`Hi ${name}`), 1000, 'Lee');

  // 두 번째 인수 생략 시 기본값 0이 지정된다
  setTimeout(() => console.log('hello'));

  // 타이머 id 반환 및 타이머 취소
  const timerId = setTimeout(() => console.log('timer ID'), 1000);
  clearTimeout(timerId);
  ```
  - setTimeout 함수는 두 번째 인수로 전달받은 시간 이후, 첫 번째로 전달받은 콜백 함수가 단 한 번 실행되도록 호출 스케줄링 된다.
  - setTimeout 함수는 생성된 타이머를 식별할 수 있는 고유한 타이머 id를 반환한다. 이는 브라우저 환경인 경우 숫자, Node.js 환경인 경우 객체다.
  - setTimeout 함수가 반환한 타이머 id를 clearTimeout 함수의 인수로 전달하여 호출 스케줄링을 취소할 수 있다.

- setInterval / clearInterval
  ```
  let count = 1

  // 1초 후 타이머 만료될 때마다 콜백 하뭇 호출
  const timeoutId = setInterval(() => {
    console.log(count);  // 1 2 3 4 5

    // count가 5면 타이머 취소
    if (count++ === 5) clearInterval(timeoutId);
  }, 1000);
  ```
  - setInterval 함수는 두 번째 인수로 전달받은 시간이 결과할 때마다 첫 번째 인수로 전달받은 콜백 함수가 반복 실행되도록 호출 스케줄링된다. setInterval 함수에 전달할 인수는 setTimeout 함수와 동일하다.
  - setTimeout 함수와 마찬가지로 setInterval 함수 역시 타이머 id를 반환하며clearInterval 함수의 인수로 전달하여 호출 스케줄링을 취소할 수 있다.

디바운스와 스로틀
---
- 디바운스와 스로틀은 scroll, resize, input, mousemove와 같이 짧은 시간 간격으로 연속해서 발생하는 이벤트를 그룹화해서 과도한 이벤트 핸들러의 호출을 방지하는 프로그래밍 기법이다.
- 디바운스
  - 디바운스는 짧은 시간 간격으로 이벤트가 연속해서 발생하면 이벤트 핸들러를 호출하지 않고 그룹화해서 마지막 한 번만 이벤트 핸들러가 호출되도록 한다.
  - 디바운스는 타이머 id를 기억하는 클로저를 반환한다. 일정 시간이 경과하기 이전에 이벤트가 발생하면 이전 타이머를 취소하고 새로운 타이머를 재설정한다. 이때 반환한 클로저가 이벤트 핸들러로 등록된다.
  - 일정 시간 동안 이벤트가 더 이상 발생하지 않으면 이벤트 핸들러가 한 번만 호출되도록 하는 디바운스는 resize, input, ajax, 버튼 중복 클릭 방지 등에 사용된다.
- 스로틀
  - 스로틀은 짧은 시간 간격으로 이벤트가 연속해서 발생하더라도 일정 시간 간격으로 이벤트 핸들러가 최대 한 번만 호출되도록 한다. 즉, 스로틀은 짧은 시간 간격으로 연속해서 발생하는 이벤트를 그룹화해서 일정 시간 단위로 이벤트 핸들러가 호출되로록 호출 주기를 만든다.
    - 스로틀은 타이머 id를 기억하는 클로저를 반환한다. 일정 시간이 경과하기 이전에 이벤트가 발생하면 아무것도 하지 않다가 일정 시간이 경과했을 때 이벤트가 발생하면 새로운 타이머를 재설정한다. 이때 반환한 클로저가 이벤트 핸들러로 등록된다.
    - 스로틀은 일정 시간 간격으로 콜백 함수가 호출된다. 이는 scroll 이벤트 처리나 무한 스크롤 구현 등에 사용된다.



